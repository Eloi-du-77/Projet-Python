import requests
import pandas as pd
from bs4 import BeautifulSoup

editions = {
    2012: "https://en.wikipedia.org/wiki/2012_Summer_Olympics_medal_table",
    2016: "https://en.wikipedia.org/wiki/2016_Summer_Olympics_medal_table",
    2020: "https://en.wikipedia.org/wiki/2020_Summer_Olympics_medal_table",
    2024: "https://en.wikipedia.org/wiki/2024_Summer_Olympics_medal_table",
}

records = []

for year, url in editions.items():
    resp = requests.get(url)
    soup = BeautifulSoup(resp.content, "html.parser")
    # repérer le bon tableau — en général le premier <table class="wikitable sortable">
    table = soup.find("table", {"class": "wikitable sortable"})
    if table is None:
        table = soup.find("table", {"class": "wikitable"})
    df = pd.read_html(str(table))[0]
    # On suppose les colonnes : Rank, NOC / Country, Gold, Silver, Bronze, Total
    df = df.rename(columns={df.columns[1]: "country", "Gold": "gold", "Silver": "silver", "Bronze": "bronze", "Total": "total"})
    df = df[["country", "gold", "silver", "bronze", "total"]]
    df["year"] = year
    records.append(df)

medals = pd.concat(records, ignore_index=True)
print(medals.head())
